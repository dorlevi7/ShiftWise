{"ast":null,"code":"var _jsxFileName = \"/Users/dorlevi/IdeaProjects/newShiftWise/client/src/components/NotificationsScreen.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { getUserNotifications, markAsRead } from '../services/notificationService';\nimport Navbar from './Navbar';\nimport '../styles/NotificationsScreen.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction NotificationsScreen() {\n  _s();\n  var _user$company, _user$user;\n  const [notifications, setNotifications] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const user = JSON.parse(localStorage.getItem('user'));\n  const companyId = user === null || user === void 0 ? void 0 : (_user$company = user.company) === null || _user$company === void 0 ? void 0 : _user$company.id;\n  const userId = user === null || user === void 0 ? void 0 : (_user$user = user.user) === null || _user$user === void 0 ? void 0 : _user$user.id;\n  useEffect(() => {\n    const fetchNotifications = async () => {\n      try {\n        const data = await getUserNotifications(companyId, userId);\n        const formatted = Object.entries(data || {}).map(([id, value]) => ({\n          id,\n          ...value\n        }));\n        setNotifications(formatted.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp)));\n      } catch (err) {\n        setError('Failed to load notifications.');\n        console.error(err);\n      } finally {\n        setLoading(false);\n      }\n    };\n    if (companyId && userId) {\n      fetchNotifications();\n    }\n  }, [companyId, userId]);\n  const handleMarkAsRead = async notificationId => {\n    await markAsRead(companyId, userId, notificationId);\n    setNotifications(prev => prev.map(n => n.id === notificationId ? {\n      ...n,\n      read: true\n    } : n));\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"navbar-placeholder\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"notifications-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Notifications\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 17\n      }, this), loading ? /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Loading...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 21\n      }, this) : error ? /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"error\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 21\n      }, this) : notifications.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"No notifications.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 21\n      }, this) : /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"notification-list\",\n        children: notifications.map(n => /*#__PURE__*/_jsxDEV(\"li\", {\n          className: `notification-item ${n.read ? 'read' : 'unread'}`,\n          onClick: () => {\n            if (!n.read) handleMarkAsRead(n.id);\n            if (n.linkTo) window.location.href = n.linkTo;\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message\",\n            children: n.message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"time\",\n            children: new Date(n.timestamp).toLocaleString()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 33\n          }, this)]\n        }, n.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 29\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 44,\n    columnNumber: 9\n  }, this);\n}\n_s(NotificationsScreen, \"AS6q/RMxLSF4b91ocJSzqFAqRUg=\");\n_c = NotificationsScreen;\nexport default NotificationsScreen;\nvar _c;\n$RefreshReg$(_c, \"NotificationsScreen\");","map":{"version":3,"names":["React","useEffect","useState","getUserNotifications","markAsRead","Navbar","jsxDEV","_jsxDEV","NotificationsScreen","_s","_user$company","_user$user","notifications","setNotifications","loading","setLoading","error","setError","user","JSON","parse","localStorage","getItem","companyId","company","id","userId","fetchNotifications","data","formatted","Object","entries","map","value","sort","a","b","Date","timestamp","err","console","handleMarkAsRead","notificationId","prev","n","read","children","fileName","_jsxFileName","lineNumber","columnNumber","className","length","onClick","linkTo","window","location","href","message","toLocaleString","_c","$RefreshReg$"],"sources":["/Users/dorlevi/IdeaProjects/newShiftWise/client/src/components/NotificationsScreen.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { getUserNotifications, markAsRead } from '../services/notificationService';\nimport Navbar from './Navbar';\nimport '../styles/NotificationsScreen.css';\n\nfunction NotificationsScreen() {\n    const [notifications, setNotifications] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState('');\n    const user = JSON.parse(localStorage.getItem('user'));\n    const companyId = user?.company?.id;\n    const userId = user?.user?.id;\n\n    useEffect(() => {\n        const fetchNotifications = async () => {\n            try {\n                const data = await getUserNotifications(companyId, userId);\n                const formatted = Object.entries(data || {}).map(([id, value]) => ({\n                    id,\n                    ...value\n                }));\n                setNotifications(formatted.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp)));\n            } catch (err) {\n                setError('Failed to load notifications.');\n                console.error(err);\n            } finally {\n                setLoading(false);\n            }\n        };\n\n        if (companyId && userId) {\n            fetchNotifications();\n        }\n    }, [companyId, userId]);\n\n    const handleMarkAsRead = async (notificationId) => {\n        await markAsRead(companyId, userId, notificationId);\n        setNotifications((prev) =>\n            prev.map((n) => (n.id === notificationId ? { ...n, read: true } : n))\n        );\n    };\n\n    return (\n        <div>\n            <Navbar />\n            <div className=\"navbar-placeholder\"></div>\n\n            <div className=\"notifications-container\">\n                <h1>Notifications</h1>\n                {loading ? (\n                    <p>Loading...</p>\n                ) : error ? (\n                    <p className=\"error\">{error}</p>\n                ) : notifications.length === 0 ? (\n                    <p>No notifications.</p>\n                ) : (\n                    <ul className=\"notification-list\">\n                        {notifications.map((n) => (\n                            <li\n                                key={n.id}\n                                className={`notification-item ${n.read ? 'read' : 'unread'}`}\n                                onClick={() => {\n                                    if (!n.read) handleMarkAsRead(n.id);\n                                    if (n.linkTo) window.location.href = n.linkTo;\n                                }}\n                            >\n                                <div className=\"message\">{n.message}</div>\n                                <div className=\"time\">{new Date(n.timestamp).toLocaleString()}</div>\n                            </li>\n                        ))}\n                    </ul>\n                )}\n            </div>\n        </div>\n    );\n}\n\nexport default NotificationsScreen;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}